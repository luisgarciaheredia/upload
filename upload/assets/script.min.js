'use strict';var app={name:"upload",users:[{user:"luisgarcia",pass:"luisgarcia",name:"Luis",type:"admin"},{user:"admin",pass:"admin",name:"Administrador",type:"admin"}],init:function(){this.set_url_base();this.set_dom();this.set_listeners();this.set_defaults();this.show_app()},set_url_base:function(){this.urlBase="luisgarciaheredia.com"===window.location.hostname?"https://luisgarciaheredia.com/entel3/entel/upload":"http://localhost/upload/upload"},set_dom:function(){this.dom={};this.dom.input_login_user=
document.querySelectorAll("#input-login-user")[0];this.dom.input_login_pass=document.querySelectorAll("#input-login-pass")[0];this.dom.form_login=document.querySelectorAll("#login form")[0];this.dom.div_login=document.querySelectorAll("#login")[0];this.dom.div_content=document.querySelectorAll("#content")[0];this.dom.link_menu=document.querySelectorAll("#side a");this.dom.file_logixtal=document.querySelectorAll("#mod_form_logixtal input")[0];this.dom.progress_label_logixtal=document.querySelectorAll("#mod_form_logixtal .progress div")[0];
this.dom.logixtal_button_guardar=document.querySelectorAll("#mod_form_logixtal button")[0];this.dom.logixtal_div_progress=document.querySelectorAll("#mod_form_logixtal .preloader-wrapper")[0];this.dom.logixtal_div_modal_content=document.querySelectorAll("#mod_form_logixtal .modal-content")[0];this.dom.form_register=document.querySelectorAll("#mod_form_pickup form")[0];this.dom.inar_filename=document.querySelectorAll("#mod_form_inar input")[0];this.dom.inar_form=document.querySelectorAll("#mod_form_inar form")[0];
this.dom.inar_button_guardar=document.querySelectorAll("#mod_form_inar button[type\x3dsubmit]")[0];this.dom.inar_div_progress=document.querySelectorAll("#mod_form_inar .preloader-wrapper")[0];this.dom.inar_div_modal_content=document.querySelectorAll("#mod_form_inar .modal-content")[0];this.dom.inarreno_filename=document.querySelectorAll("#mod_form_inarreno input")[0];this.dom.inarreno_form=document.querySelectorAll("#mod_form_inarreno form")[0];this.dom.inarreno_button_guardar=document.querySelectorAll("#mod_form_inarreno button[type\x3dsubmit]")[0];
this.dom.inarreno_div_progress=document.querySelectorAll("#mod_form_inarreno .preloader-wrapper")[0];this.dom.inarreno_div_modal_content=document.querySelectorAll("#mod_form_inarreno .modal-content")[0]},set_listeners:function(){var a=this;a.dom.form_login.addEventListener("submit",a.submit_form_login.bind(a));a.dom.link_menu.forEach(function(b){b.addEventListener("click",a.click_link_menu.bind(a))});a.dom.file_logixtal.addEventListener("change",a.change_file_logixtal.bind(a));a.dom.inar_form.addEventListener("submit",
a.submit_inar_form.bind(a));a.dom.inarreno_form.addEventListener("submit",a.submit_inarreno_form.bind(a))},set_progress_bar_label:function(a){this.progress_bar_label.style.width=a},reset_progress_bar_label:function(){this.progress_bar_label.style.width="0%"},show_preloader:function(){this.div_progress.classList.remove("hide");this.div_modal_content.classList.add("hide");this.button_guardar.classList.add("disabled")},hide_preloader:function(){this.div_progress.classList.add("hide");this.div_modal_content.classList.remove("hide");
this.button_guardar.classList.remove("disabled")},click_link_menu:function(a){this.menu_item=a.target.id;"lnk_pickup"===this.menu_item?this.click_pickup_menu():"lnk_logixtal"===this.menu_item?this.click_logixtal_menu():"lnk_inar"===this.menu_item?this.click_inar_menu():"lnk_inarreno"===this.menu_item&&this.click_inarreno_menu()},click_pickup_menu:function(){},click_logixtal_menu:function(){this.progress_bar_label=this.dom.progress_label_logixtal;this.div_progress=this.dom.logixtal_div_progress;this.div_modal_content=
this.dom.logixtal_div_modal_content;this.button_guardar=this.dom.logixtal_button_guardar},click_inar_menu:function(){this.div_progress=this.dom.inar_div_progress;this.div_modal_content=this.dom.inar_div_modal_content;this.button_guardar=this.dom.inar_button_guardar},click_inarreno_menu:function(){this.div_progress=this.dom.inarreno_div_progress;this.div_modal_content=this.dom.inarreno_div_modal_content;this.button_guardar=this.dom.inarreno_button_guardar},change_file_logixtal:function(){var a=this;
a.sendFileRequest(a.dom.file_logixtal.files[0],"POST",a.urlBase+"/api/logixtal/update/").then(function(b){a.hide_preloader();M.toast({html:b.message,classes:"rounded"});console.log(b)},function(a){console.log(a)})},submit_inar_form:function(a){var b=this;a.stopPropagation();a.preventDefault();b.show_preloader();b.sendRequest("filename\x3d"+b.dom.inar_filename.value,"POST",b.urlBase+"/api/inar/update/").then(function(a){b.hide_preloader();M.toast({html:a.message,classes:"rounded"});console.log(a)},
function(a){console.log(a)})},submit_inarreno_form:function(a){var b=this;a.stopPropagation();a.preventDefault();b.show_preloader();b.sendRequest("filename\x3d"+b.dom.inarreno_filename.value,"POST",b.urlBase+"/api/inarreno/update/").then(function(a){b.hide_preloader();M.toast({html:a.message,classes:"rounded"});console.log(a)},function(a){console.log(a)})},submit_form_login:function(a){a.preventDefault();var b=this.dom.input_login_user.value,f=this.dom.input_login_pass.value,c="",d=!1;this.users.forEach(function(a){a.user===
b&&a.pass===f&&(d=!0,c=a.name)});d?(M.toast({html:"\u00a1Login exitoso! Bienvenido, "+c+".",classes:"rounded"}),window.localStorage.setItem(this.name+"_logged","1"),window.localStorage.setItem(this.name+"_user",b),this.dom.div_login.classList.add("hide"),this.dom.div_content.classList.remove("hide")):M.toast({html:"Usuario o contrase\u00f1a incorrecta.",classes:"rounded"})},set_defaults:function(a){a={opacity:.75};var b=document.querySelectorAll(".modal");M.Modal.init(b,a);b=document.querySelectorAll("select");
M.FormSelect.init(b,a)},show_app:function(){"1"===window.localStorage.getItem(this.name+"_logged")?(this.dom.div_login.classList.add("hide"),this.dom.div_content.classList.remove("hide")):(this.dom.div_login.classList.remove("hide"),this.dom.div_content.classList.add("hide"))},sendRequest:function(a,b,f){var c=new XMLHttpRequest;return new Promise(function(d,e){c.onreadystatechange=function(){4===c.readyState&&(300<=c.status?e("Error, status code \x3d "+c.status):d(JSON.parse(c.response)))};c.open(b,
f);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.send(a)})},sendFileRequest:function(a,b,f){var c=this,d=new FormData;d.append("file1",a);var e=new XMLHttpRequest;return new Promise(function(a,g){e.upload.addEventListener("progress",function(a){a=a.loaded/a.total*100;c.progress_bar_label.style.width=Math.round(a)+"%";100===a&&c.show_preloader()},!1);e.addEventListener("load",function(b){c.progress_bar_label.style.width="0%";c.hide_preloader();a(JSON.parse(b.target.response))},
!1);e.addEventListener("error",function(a){g("Error, status code \x3d "+a.target.status)});e.open(b,f);e.send(d)})}};document.addEventListener("DOMContentLoaded",function(){app.init()});